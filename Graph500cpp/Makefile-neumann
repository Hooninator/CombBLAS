INCDIR = $(HOME)
INCADD = -I$(INCDIR)

# notes for configure:
# -fno-exceptions does not work with MPICH2
# -fno-rtti does not work with tr1:tuples

OPT = -DNDEBUG -O3 -DMPICH_IGNORE_CXX_SEEK
DEB = -g -O0 -fno-inline -DMPICH_IGNORE_CXX_SEEK #-DDEBUG
COMPILER = mpicxx
FLAGS = $(DEB)

all: graph500

CommGrid.o:	../CombBLAS/CommGrid.cpp ../CombBLAS/CommGrid.h
	$(COMPILER) $(INCADD) $(FLAGS) -c -o CommGrid.o ../CombBLAS/CommGrid.cpp

MPIType.o:	../CombBLAS/MPIType.cpp ../CombBLAS/MPIType.h
	$(COMPILER) $(INCADD) $(FLAGS) -c -o MPIType.o ../CombBLAS/MPIType.cpp

MemoryPool.o:	../CombBLAS/MemoryPool.cpp ../CombBLAS/SpDefs.h
	$(COMPILER) $(INCADD) $(FLAGS) -c -o MemoryPool.o ../CombBLAS/MemoryPool.cpp

graph500.o: graph500.cpp ../CombBLAS/SpDCCols.cpp ../CombBLAS/dcsc.cpp ../CombBLAS/SpHelper.h ../CombBLAS/SpParMat.h ../CombBLAS/ParFriends.h ../CombBLAS/SpParMat.cpp ../CombBLAS/SpDefs.h ../CombBLAS/SpTuples.cpp
	$(COMPILER) $(INCADD) $(FLAGS) -c -o graph500.o graph500.cpp

graph500:	MemoryPool.o CommGrid.o MPIType.o graph500.o
	$(COMPILER) $(INCADD) $(FLAGS) -o graph500 graph500.o MemoryPool.o CommGrid.o MPIType.o



clean:
	rm -f graph500 
	rm -f *.o

cleanout:
	rm out.*
	rm err.*
